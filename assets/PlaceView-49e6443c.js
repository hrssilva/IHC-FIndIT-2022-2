import{I as f,a as o,R as _,H as g}from"./ImageCanvas-865a4a0f.js";import{_ as v,r as M,o as p,c as m,a as N,t as d,b as h,g as C}from"./index-1fd2e2ff.js";const y={components:{ImageCanvas:f},data(){return{place:{name:"",maps:[]},currentMap:0}},mounted(){const a=Number(this.$route.params.id),s=localStorage.getItem("places");this.place=s?JSON.parse(s)[a]:{name:"",maps:[]}},computed:{imageCanvas(){return this.$refs.image}},watch:{currentMap(a,s){this.$nextTick(()=>{this.imageCanvas.draw()})}},methods:{handleFindNode(a){this.place.maps[this.currentMap].nodes.some((s,n)=>{const t=this.isOverNode(s,n,a.offsetX,a.offsetY).found;return t&&s.state===o.Normal?s.state=o.Hovered:!t&&s.state===o.Hovered&&(s.state=o.Normal),t}),this.imageCanvas.draw()},handleSelectNode(a){this.place.maps[this.currentMap].nodes.some((s,n)=>{const t=this.isOverNode(s,n,a.offsetX,a.offsetY);return t.found&&(this.currentMap=t.destiny),t.found})},isOverNode(a,s,n,t){let e=-1;if(!this.place.maps[this.currentMap].edges.some(i=>{const l=i.end.map!==this.currentMap&&i.start.node===s;return l&&(e=i.end.map),l}))return{found:!1,destiny:e};const c=a.x*this.imageCanvas.$refs.canvas.width,u=a.y*this.imageCanvas.$refs.canvas.height;return{found:Math.sqrt(Math.pow(n-c,2)+Math.pow(t-u,2))<_+g,destiny:e}}}};const w={class:"container"},O={class:"see-places-title"},S={key:0,class:"see-places-subtitle"};function k(a,s,n,t,e,r){const c=M("ImageCanvas");return p(),m("div",w,[N("h1",O,d(e.place.name),1),e.place.maps.length>0?(p(),m("h2",S,d(e.place.maps[e.currentMap].name),1)):h("",!0),e.place.maps.length>0?(p(),C(c,{key:1,image:e.place.maps[e.currentMap].image,nodes:e.place.maps[e.currentMap].nodes,"only-real":!0,edges:e.place.maps[e.currentMap].edges,onMousemove:r.handleFindNode,onClick:r.handleSelectNode,ref:"image"},null,8,["image","nodes","edges","onMousemove","onClick"])):h("",!0)])}const H=v(y,[["render",k]]);export{H as default};
